<div class="carousel-z">
  <% if @pot.photos.attached? %>
    <div id="pot-caro-img" >
      <%= cl_image_tag @pot.photos.last.key, height: 300, crop: :fill, class: "plant-pic" %>
    </div>
  <% else %>
    <div id="pot-caro-img">
      <%= image_tag @pot.plant.cover_picture, class: "plant-pic" %>
    </div>
  <% end %>
</div>
<button type="button" class="btn btn-primary" id="carousel-modal-button" data-toggle="modal" data-target="#exampleModal">
  <i class="fas fa-images"></i>
</button>
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">
          <% if @pot.nickname.present? %>
            <%= @pot.nickname %>
          <% else %>
            <%= @pot.plant.name %>
          <% end %>
          's photos!
        </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <% if @pot.photos.attached? %>
          <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
              <% @pot.photos.each_with_index do |photo, index| %>
                <% if index == 0 %>
                  <div id="pot-caro-img" class="carousel-item active">
                    <%= cl_image_tag photo.key, height: 300, crop: :fill %>
                  </div>
                <% else %>
                  <div id="pot-caro-img" class="carousel-item">
                    <%= cl_image_tag photo.key, height: 300, crop: :fill %>
                  </div>
                <% end %>
              <% end %>
              <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>
          </div>
        <% else %>
          <p>Upload your first photo of
            <% if @pot.nickname.present? %>
              <%= @pot.nickname %>
            <% else %>
              <%= @pot.plant.name %>
            <% end %>
          </p>
        <% end %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <div class="picture-button">
          <%= simple_form_for @pot, html: {id: "picture_upload"}, remote: true do |f| %>
            <%= f.input :photos, as: :file, input_html: { multiple: true }, label: false %>
            <%= f.submit %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
